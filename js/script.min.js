const startDate = new Date("2015-08-06T08:05:00Z"), targetDate = new Date("2025-08-06T08:05:00Z"); let windowBlur = false; const getLabel = (v, u) => { const forms = { "dzień": ["dzień", "dni", "dni"], "godzina": ["godzina", "godziny", "godzin"], "minuta": ["minuta", "minuty", "minut"], "sekunda": ["sekunda", "sekundy", "sekund"] }; if (!forms[u]) return ""; return v === 1 ? forms[u][0] : (v % 10 >= 2 && v % 10 <= 4 && (v % 100 < 10 || v % 100 >= 20)) ? forms[u][1] : forms[u][2]; }; window.addEventListener("blur", () => windowBlur = true); window.addEventListener("focus", () => windowBlur = false); const updateCountdown = () => { const now = new Date(), diff = Math.max(targetDate - now, 0), totalSeconds = Math.ceil(diff / 1000), days = Math.floor(totalSeconds / 86400), hours = Math.floor((totalSeconds % 86400) / 3600), minutes = Math.floor((totalSeconds % 3600) / 60), seconds = totalSeconds % 60, progress = Math.min(Math.max(((now - startDate) / (targetDate - startDate)) * 100, 0), 100); document.getElementById("progressBar").style.width = `${progress}%`; document.getElementById("progressLabel").textContent = progress.toLocaleString("pl-PL", { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + "%"; const units = [{ value: days, unit: "dzień" }, { value: hours, unit: "godzina" }, { value: minutes, unit: "minuta" }, { value: seconds, unit: "sekunda" }]; let startIndex = 0; while (startIndex < units.length - 1 && units[startIndex].value === 0) startIndex++; const tilesContainer = document.getElementById("tilesContainer"); tilesContainer.innerHTML = ""; let lastTwoTilesContainer = null, ddhhmmss = ""; for (let i = startIndex; i < units.length; i++) { const tile = document.createElement("div"); tile.className = "tile"; const numberElem = document.createElement("div"); numberElem.className = "tile-number"; numberElem.textContent = units[i].value; const labelElem = document.createElement("div"); labelElem.className = "tile-label"; labelElem.textContent = getLabel(units[i].value, units[i].unit); tile.appendChild(numberElem); tile.appendChild(labelElem); if (i === units.length - 1 || i === units.length - 2) { if (!lastTwoTilesContainer) lastTwoTilesContainer = document.createElement("div"); lastTwoTilesContainer.className = "tiles"; lastTwoTilesContainer.appendChild(tile); } else { tilesContainer.appendChild(tile); } ddhhmmss += units[i].value.toString().padStart(2, "0"); if (i !== units.length - 1) ddhhmmss += ":"; } if (lastTwoTilesContainer) tilesContainer.appendChild(lastTwoTilesContainer); document.title = windowBlur ? ddhhmmss : "Ile dni zostało do końca kadencji Andrzeja Dudy?"; setTimeout(updateCountdown, 1000 - now.getMilliseconds()); }; updateCountdown();
